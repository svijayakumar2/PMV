# Configuration for Pure Stackelberg Prover-Verifier Game (No Ground Truth)

model:
  name: "Qwen/Qwen2-0.5B"  
  num_verifiers: 3
  prover_name: "Qwen/Qwen2.5-3B-Instruct"     
  verifier_name: "deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B"       

training:
  # Core settings
  rounds: 15
  use_lora: true
  
  # Reward type options: "pure_convincingness", "disagreement"
  reward_type: "pure_convincingness"
  
  # PPO settings for prover
  k_episodes: 8000  # Number of episodes per round
  prover_lr: 5e-5
  ppo_epochs:  4  
  clip_ratio: 0.2
  kl_coeff: 0.001
  
  # Verifier training (Stackelberg leaders)
  verifier_lr: 1e-5
  verifier_epochs:   5  
  
  # Learned aggregator settings
  learn_f: false  # Set to true to use learned aggregator
  aggregation_type: "pl_min"  # "pl_min" or "pe_min"
  aggregator_steps: 50
  aggregator_batch_size: 8
  aggregator_lr: 1e-4
  
  # LoRA settings
  lora_r: 8
  lora_alpha: 32
  lora_dropout: 0.1
  lora_target_modules: ["q_proj", "v_proj", "k_proj", "o_proj"]
  
  # Data and replay
  max_replay_size: 1000
  save_every: 1 # 5 

logging:
  logdir: "runs/pure_stackelberg_experiment"

# Pure Stackelberg specific settings
stackelberg:
  # How verifiers learn without ground truth - CHOOSE ONE:
  # "self_consistency" - Weakest, verifiers just try to be consistent
  # "adversarial_robust" - BEST for sneaky dynamics, actively defends against attacks  
  # "consensus_disagreement" - Verifiers learn to agree on helpful, disagree on sneaky
  # "meta_learning" - Learn to quickly adapt to new sneaky strategies
  verifier_training_method: "adversarial_robust"
  
  # Reward function parameters
  convincingness_weight: 1.0
  disagreement_weight: 0.5
  consistency_weight: 0.1
  
  # Verifier commitment strategy
  verifier_commitment_rounds: 3  # How many rounds verifiers "commit" before updating
  
  # Adversarial training specific
  sneaky_penalty_threshold: 0.3  # Penalize sneaky scores above this
  helpful_reward_threshold: 0.7  # Reward helpful scores above this
  margin_strength: 0.4  # How much separation to enforce
